<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> AngularJS项目笔记 · gaochen</title><meta name="description" content="AngularJS项目笔记 - gaochen"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="https://github.com/gaochen" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">AngularJS项目笔记</h1><div class="post-time">Jun 22, 2016</div><div class="post-content"><p>项目需要做一个后台管理系统，前端负责人选择使用AngularJS来实现，我主要是做里面的一些页面和功能开发，以及最后测试的时候Bug的修改。这是我第一次在项目中使用AngularJS，所以在开发过程中遇到了一些问题，本文主要是做一个总结。</p>
<h3 id="ng-repeat报错"><a href="#ng-repeat报错" class="headerlink" title="ng-repeat报错"></a>ng-repeat报错</h3><p><strong>情景：</strong> </p>
<p>使用ng-repeat指令遍历一个JavaScript数组时，当数组中有重复元素的时候，AngularJS就会报错：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Error: [ngRepeat:dupes] Duplicates in a repeater are not allowed. Use &apos;track by&apos; </span><br><span class="line">expression to specify unique keys.</span><br></pre></td></tr></table></figure></p>
<a id="more"></a>
<p><strong>解决：</strong></p>
<p>这是因为ng-Repeat不允许collection中存在两个相同Id的对象。对于数字或者字符串等基本数据类型来说，它的id就是它自身的值。因此数组中是不允许存在两个相同的数字的。为了规避这个错误，需要定义自己的track by表达式。解决办法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 业务上自己生成唯一的id</span><br><span class="line">item in items track by item.id</span><br><span class="line"></span><br><span class="line">//或者直接拿循环的索引变量$index来用</span><br><span class="line">item in items track by $index</span><br></pre></td></tr></table></figure></p>
<h3 id="option使用ng-repeat多出一行空白项"><a href="#option使用ng-repeat多出一行空白项" class="headerlink" title="option使用ng-repeat多出一行空白项"></a>option使用ng-repeat多出一行空白项</h3><p><strong>情景：</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span>  <span class="attr">ng-model</span>=<span class="string">"list.selected"</span> <span class="attr">ng-change</span>=<span class="string">"isStatus(list.selected)"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>  <span class="attr">ng-repeat</span>=<span class="string">"x in opts "</span> <span class="attr">value</span>=<span class="string">"&#123;&#123;x.val&#125;&#125;"</span>  <span class="attr">ng-selected</span>=<span class="string">"x.val==isComplete"</span>&gt;</span></span><br><span class="line">        &#123;&#123;x.name&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>在使用上面的代码创建options的时候，在浏览器中会出多一行空白项，html解析出来的代码是<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"? undefined:undefined ?"</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><strong>解决：</strong></p>
<p>这是因为没有初始化select的值，需要用ng-init来初始化一下select的值。但是如果将select的值初始化为某一项option时，我遇到了一个新的bug（第一次选择下拉无效）。因此，我直接将select初始化为一个隐藏掉的option值，这样就能解决所有bug，代码如下：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span>  <span class="attr">ng-model</span>=<span class="string">"list.selected"</span> <span class="attr">ng-change</span>=<span class="string">"isStatus(list.selected)"</span></span><br><span class="line"> <span class="attr">ng-init</span>=<span class="string">"list.selected = 'default' "</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"default"</span> <span class="attr">style</span>=<span class="string">"display:none;"</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>  <span class="attr">ng-repeat</span>=<span class="string">"x in opts "</span> <span class="attr">value</span>=<span class="string">"&#123;&#123;x.val&#125;&#125;"</span>  <span class="attr">ng-selected</span>=<span class="string">"x.val==isComplete"</span>&gt;</span></span><br><span class="line">        &#123;&#123;x.name&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="bootstrap：td标签固定宽度且超宽添加省略号"><a href="#bootstrap：td标签固定宽度且超宽添加省略号" class="headerlink" title="bootstrap：td标签固定宽度且超宽添加省略号"></a>bootstrap：td标签固定宽度且超宽添加省略号</h3><p><strong>需求：</strong></p>
<p>td标签需要固定宽度，当内容过长时自动省略后面部分并添加省略号</p>
<p><strong>解决：</strong></p>
<p>这里需要使用table-layout:fixed，它的作用是让布局基于第一行所设置的宽度来展示内容，即接下来的内容 都将跟随第一行的宽度来变化。如下，title01所在的td的宽度始终占整个table宽度的20%，而title02所在的td的宽度始终占整个table宽度的80%。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span> <span class="attr">width</span>=<span class="string">"20%"</span>&gt;</span>Title01<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span> <span class="attr">width</span>=<span class="string">"80%"</span>&gt;</span>Title02<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>title01<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">style</span>=<span class="string">"overflow:hidden;white-space:nowrap;text-overflow:ellipsis;"</span>&gt;</span>title02<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>然后结合使用“overflow:hidden;white-space:nowrap;text-overflow:ellipsis;”，就可以实现内容超长后自动添加省略号</p>
</div></article></div></section><footer><div class="paginator"><a href="/2016/07/12/20160712/" class="prev">PREV</a><a href="/2016/06/12/20160612/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2017 <a href="http://yoursite.com">gaochen</a>, unless otherwise noted.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?a36e15d9e2adec9a21fcdd9f686b1ed2";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>